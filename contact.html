<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Contact & Quotes | Retro-ER Electronics Repair</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
  <div class="nav-inner">
    <a href="index.html" class="logo">
      <img src="Icon.png" alt="Retro-ER Logo">
      <div class="logo-text">
        <div>RETRO<span>-ER</span></div>
        <div style="color:var(--muted); font-weight:400;">Electronics Repair</div>
      </div>
    </a>
    <div class="mobile-nav-wrapper">
      <a href="contact.html" class="btn btn-primary" style="font-size: 0.85rem; padding: 0.5rem 1rem;">Book a repair</a>
      <div class="hamburger" onclick="toggleMenu()">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
    <nav class="nav-links" id="navLinks">
      <a href="index.html">Home</a>
      <a href="how-it-works.html">How it works</a>
      <a href="about.html">About</a>
      <a href="gallery.html">Gallery</a>
      <a href="contact.html" class="btn btn-primary">Book a repair</a>
    </nav>
  </div>
</header>

<main>
  <section id="contact">
    <h2>Contact & quotes</h2>
    <p class="section-intro">
      Use this form to request a repair, ask about a build, or check if your device is something I work on.
    </p>
    <div class="contact">
      <div class="contact-details">
        <img src="Icon.png" alt="Retro-ER Logo">
        <p><strong>Email:</strong> <a href="mailto:contact@retro-er.com">contact@retro-er.com</a></p>
        <p><strong>Phone:</strong> (402) 885-9837</p>
        <p><strong>Location:</strong> Kearney, NE<br>Remote & ship-in service available</p>
        <p><strong>Payment:</strong> PayPal only</p>
        <p>
          Typical response time is within 1 business day. If you don't hear back, check your spam folder
          or text after emailing.
        </p>
      </div>
      <form class="contact-form" id="contactForm">
        <div class="field">
          <label for="name">Name</label>
          <input id="name" name="name" type="text" placeholder="First and Last name" required>
        </div>
        <div class="field">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" placeholder="you@example.com" required>
        </div>
        <div class="field">
          <label for="device">Device / model</label>
          <input id="device" name="device" type="text" placeholder="e.g. PS5, Nintendo Switch, custom PC, etc." required>
        </div>
        <div class="field">
          <label for="message">Issue description</label>
          <textarea id="message" name="message" rows="4" placeholder="Be as descriptive as possible for the most accurate quote, and be honest - I don't judge. Include any history, error messages, or liquid/impact damage." required></textarea>
        </div>
        <div class="field">
          <label for="photos">Photos (optional but encouraged)</label>
          <div class="file-upload-wrapper">
            <input id="photos" name="photos" type="file" accept="image/*" multiple class="file-upload-input">
            <label for="photos" class="file-upload-label">
              ðŸ“· Include serial number tag, damage, or any relevant photos
            </label>
          </div>
        </div>
        <button class="btn btn-primary" type="submit">Send request</button>
        <div id="formStatus" style="margin-top: 1rem; padding: 1rem; border-radius: 0.5rem; display: none;"></div>
      </form>
    </div>
  </section>
</main>

<footer>
  &copy; <span id="year"></span> Retro-ER Electronics Repair. All rights reserved.
</footer>

<script>
  document.getElementById('year').textContent = new Date().getFullYear();

  function toggleMenu() {
    document.getElementById('navLinks').classList.toggle('active');
  }

  // Handle contact form submission via Cloudflare Pages Function
  document.getElementById('contactForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const formStatus = document.getElementById('formStatus');
    const submitBtn = this.querySelector('button[type="submit"]');

    // Disable submit button
    submitBtn.disabled = true;
    submitBtn.textContent = 'Sending...';

    // Create FormData object
    const formData = new FormData(this);

    try {
      // Submit to Cloudflare Pages Function
      const response = await fetch('/submit-contact', {
        method: 'POST',
        body: formData
      });

      const result = await response.json();

      if (result.success) {
        // Show success message
        formStatus.style.display = 'block';
        formStatus.style.background = 'rgba(46, 213, 115, 0.1)';
        formStatus.style.color = '#2ed573';
        formStatus.style.border = '1px solid #2ed573';
        formStatus.textContent = 'Message sent successfully! I\'ll get back to you within 1 business day.';

        // Reset form
        this.reset();
      } else {
        throw new Error(result.error || 'Submission failed');
      }
    } catch (error) {
      console.error('Error submitting form:', error);

      // Show error message
      formStatus.style.display = 'block';
      formStatus.style.background = 'rgba(255, 71, 87, 0.1)';
      formStatus.style.color = '#ff4757';
      formStatus.style.border = '1px solid #ff4757';
      formStatus.textContent = 'Error sending message. Please email me directly at contact@retro-er.com or call (402) 885-9837.';
    } finally {
      // Re-enable submit button
      submitBtn.disabled = false;
      submitBtn.textContent = 'Send request';
    }
  });
</script>
</body>
</html>
